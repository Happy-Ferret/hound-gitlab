App.directive 'repo', [ ->
  scope: true
  templateUrl: '/templates/repo'
  link: (scope, element, attributes) ->
    activateRepo = ->
      scope.processing = true

      scope.repo.$activate()
        .catch(-> alert('Your repo failed to activate.'))
        .finally(-> scope.processing = false)

    deactivateRepo = ->
      scope.processing = true

      scope.repo.$deactivate()
        .catch(-> alert('Your repo failed to deactivate.'))
        .finally(-> scope.processing = false)

    scope.toggle = ->
      if scope.repo.active
        deactivateRepo()
      else
        activateRepo()
]
